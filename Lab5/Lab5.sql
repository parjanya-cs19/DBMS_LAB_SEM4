CREATE DATABASE STUDENT_ENROLLMENT;
USE STUDENT_ENROLLMENT;
CREATE TABLE STUDENT(
REGNO VARCHAR(10),
NAME VARCHAR(20),
MAJOR VARCHAR(5),
BDATE DATE,
PRIMARY KEY(REGNO)
);

CREATE TABLE COURSE(
COURSE_NO INT,
CNAME VARCHAR(5),
DEPT VARCHAR(5),
PRIMARY KEY(COURSE_NO)
);
ALTER TABLE COURSE DROP COLUMN DEPT;
ALTER TABLE COURSE ADD COLUMN DEPT VARCHAR(5);

CREATE TABLE ENROLL(
REGNO VARCHAR(10),
COURSE_NO INT,
MARKS INT,
SEM INT,
PRIMARY KEY(REGNO, COURSE_NO),
FOREIGN KEY(REGNO) REFERENCES STUDENT(REGNO),
FOREIGN KEY(COURSE_NO) REFERENCES COURSE(COURSE_NO)
);

CREATE TABLE BOOK_ADOPTION(
COURSE_NO INT,
SEM INT,
BOOK_ISBN INT,
FOREIGN KEY(COURSE_NO) REFERENCES COURSE(COURSE_NO),
FOREIGN KEY(BOOK_ISBN) REFERENCES TEXTBOOK(BOOK_ISBN)
);

CREATE TABLE TEXTBOOK(
BOOK_ISBN INT,
BOOKTITLE VARCHAR(50),
PUBLISHER VARCHAR(20),
AUTHOR VARCHAR(20),
PRIMARY KEY(BOOK_ISBN)
);


INSERT INTO STUDENT VALUES
("CS01","RAM","DS","1986-03-12"),
("IS02","SMITH","USP","1987-12-21"),
("EC03","AHMED","SNS","1985-04-17"),
("CS03","SNEHA","DBMS","1987-01-01"),
("TC05","AKHILA","EC","1986-10-06");

INSERT INTO COURSE VALUES
(11,"DS","CS"),
(22,"USP","IS"),
(33,"SNS","EC"),
(44,"DBMS","CS"),
(55,"EC","TC");

INSERT INTO ENROLL VALUES
("CS01",11,4,85),
("IS02",22,6,80),
("EC03",33,2,80),
("CS03",44,6,75),
("TC05",55,2,8);

INSERT INTO TEXTBOOK VALUES
(1,"DS AND C","PRINCETON","PADMA REDDY"),
(2,"FUNDAMENTALS OF C","PRINCETON","GODSE"),
(3,"FUNDAMENTALS OF DBMS","PRINCETON","NAVATHE"),
(4,"SQL","PRINCETON","FOLEY"),
(5,"ELECTRONIC CIRCUITS","TMH","ELMASRI"),
(6,"ADV UNIX PROG","TMH","STEVENS");


INSERT INTO BOOK_ADOPTION VALUES
(11,4,1),
(11,4,2),
(44,6,3),
(44,6,4),
(55,2,5),
(22,6,6);




/*QUES 1*/
INSERT INTO TEXTBOOK VALUES(7,"JAVA THE COMPLETE REFERENCE","ORACLE PRESS","HERBERT SCHILDT");
INSERT INTO BOOK_ADOPTION VALUES(55,2,7);

/*QUES 2*/
SELECT C.COURSE_NO,TB.BOOK_ISBN,TB.BOOKTITLE FROM TEXTBOOK TB, COURSE C, BOOK_ADOPTION BA 
WHERE TB.BOOK_ISBN=BA.BOOK_ISBN AND BA.COURSE_NO=C.COURSE_NO AND C.DEPT="CS"
GROUP BY C.COURSE_NO HAVING COUNT(BA.BOOK_ISBN)>=2;

/*QUES 3*/

SELECT DISTINCT C.DEPT FROM COURSE C
INNER JOIN BOOK_ADOPTION BA 
ON BA.COURSE_NO=C.COURSE_NO
INNER JOIN TEXTBOOK TB
ON TB.BOOK_ISBN=BA.BOOK_ISBN
WHERE TB.PUBLISHER="PRINCETON";